<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¶ Verificador de Extratos Banc√°rios</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-university"></i> Verificador de Extratos Banc√°rios</h1>
            <p class="subtitle">Compare valores do PDF com movimentos dos extratos CSV</p>
        </header>

        <main>
            <!-- Se√ß√£o de Upload de Ficheiros -->
            <section class="upload-section">
                <h2><i class="fas fa-upload"></i> Selecionar Ficheiros</h2>
                
                <div class="file-input-group">
                    <label for="csv1">
                        <i class="fas fa-file-csv"></i> Extrato CSV 1:
                    </label>
                    <input type="file" id="csv1" accept=".csv" />
                    <span class="file-status" id="csv1-status">Nenhum ficheiro selecionado</span>
                </div>

                <div class="file-input-group">
                    <label for="csv2">
                        <i class="fas fa-file-csv"></i> Extrato CSV 2:
                    </label>
                    <input type="file" id="csv2" accept=".csv" />
                    <span class="file-status" id="csv2-status">Nenhum ficheiro selecionado</span>
                </div>

                <div class="file-input-group">
                    <label for="excel">
                        <i class="fas fa-file-excel"></i> Folha de Cofre Excel (.xlsx/.xls):
                    </label>
                    <input type="file" id="excel" accept=".xlsx,.xls" />
                    <span class="file-status" id="excel-status">Nenhum ficheiro selecionado</span>
                </div>
            </section>

            <!-- Se√ß√£o de Valores do Excel (ou entrada manual) -->
            <section class="excel-values-section">
                <h2><i class="fas fa-euro-sign"></i> Valores da Folha de Cofre</h2>
                <p class="instruction">
                    Os valores ser√£o extra√≠dos automaticamente do Excel, ou insira manualmente se necess√°rio:
                </p>
                <textarea 
                    id="excel-values" 
                    placeholder="Valores ser√£o carregados automaticamente do Excel...&#10;&#10;Ou insira manualmente:&#10;Exemplo: 123.45, 67.89, 100.00&#10;Ou:&#10;123.45&#10;67.89&#10;100.00"
                ></textarea>
                <div class="excel-values-info">
                    <small><i class="fas fa-info-circle"></i> Formatos aceites: 123,45‚Ç¨ | 123.45 EUR | ‚Ç¨123,45 | 123.45</small>
                </div>
            </section>

            <!-- Bot√µes de A√ß√£o -->
            <section class="actions">
                <button id="process-btn" class="btn btn-primary">
                    <i class="fas fa-cogs"></i> Processar Ficheiros
                </button>
                <button id="compare-btn" class="btn btn-secondary" disabled>
                    <i class="fas fa-balance-scale"></i> Comparar Valores
                </button>
                <button id="export-btn" class="btn btn-success" disabled>
                    <i class="fas fa-download"></i> Exportar Relat√≥rio
                </button>
                <button id="clear-btn" class="btn btn-warning">
                    <i class="fas fa-trash"></i> Limpar Tudo
                </button>
            </section>

            <!-- √Årea de Resultados -->
            <section class="results-section">
                <h2><i class="fas fa-chart-bar"></i> Resultados</h2>
                <div id="results" class="results-container">
                    <div class="welcome-message">
                        <h3>üëã Bem-vindo ao Verificador de Extratos!</h3>
                        <ol>
                            <li>Selecione os 2 ficheiros CSV dos extratos</li>
                            <li>Selecione o ficheiro Excel da folha de cofre</li>
                            <li>Clique em "Processar Ficheiros"</li>
                            <li>Depois clique em "Comparar Valores"</li>
                            <li>Exporte o relat√≥rio final</li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- Estat√≠sticas R√°pidas -->
            <section class="stats-section" id="stats" style="display: none;">
                <div class="stat-card">
                    <div class="stat-number" id="total-movements">0</div>
                    <div class="stat-label">Movimentos Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pdf-values-count">0</div>
                    <div class="stat-label">Valores Excel</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="matches-count">0</div>
                    <div class="stat-label">Correspond√™ncias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="no-matches-count">0</div>
                    <div class="stat-label">N√£o Encontrados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="match-rate">0%</div>
                    <div class="stat-label">Taxa Correspond√™ncia</div>
                </div>
            </section>
        </main>

        <footer>
            <p>
                <i class="fas fa-shield-alt"></i> 
                Todos os dados s√£o processados localmente no seu browser. 
                Nenhuma informa√ß√£o √© enviada para servidores externos.
            </p>
            <p>
                <i class="fas fa-code"></i> 
                Aplica√ß√£o Web | 
                <i class="fas fa-github"></i> 
                Pronta para GitHub Pages
            </p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Processando ficheiros...</p>
        </div>
    </div>

    <!-- SheetJS for Excel file reading -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
